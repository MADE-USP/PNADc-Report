file_path <- paste0(file_directory, folder_path, "PNADc_", q, "_",i, ".RData")
load(file_path)
#load("H:/Meu Drive/Documentos/Made/relatorio_pnad/PNAD_dados_relatorio_04_2023.RData")
#load("H:/Meu Drive/Documentos/Made/relatorio_pnad/dados_serie_historica_042023.RData")
# Corrigindo as datas
# Para lidar com datas no R, é preciso um formato bem especifico
# vamos entao editar o formato atual, que esta em "character" para um formato data
# Para isso, o R precisa da data num formato AA-MM-DD (ainda que o dia nao importe pra dados trimestrais)
# Vamos fazer um passo a passo disso aqui
# Primeiro, vamos dividir a coluna de data em uma de ano, e uma de trimestre:
date <- do.call(rbind, strsplit(EMPREGO.RG.sh$Trimestre, " ")) # dividindo a data pelo "espaco": ano e trimestre
colnames(date)[colnames(date) <- c("Ano", "Trimestre")] # colocando nomes corretos nas colunas
EMPREGO.RG.sh <- EMPREGO.RG.sh %>%
select(Ocupado, Categoria)
EMPREGO.RG.sh <- cbind(EMPREGO.RG.sh,date) # juntando com o data frame anterior
# Tendo as colunas de Ano e Trimestre, agora temos que criar as variaveis de dia e mes
EMPREGO.RG.sh$Dia <- 01  # considere o dia igual para todos (o dia não vai importar)
# Para criar o mes, temos que criar um padrao para que, a partir do mes, se identifique o trimestre
# Fazemos entao pelo primeiro mes: mes 1 p/ o 1o trimestre; mes 4 p/ o 2o trimestre, etc
# (aqui tambem tanto faz qual mes voce escolhe, so tem que estar dentro do trimestre certo)
# criamos um loop para ajustar o mes a partir do trimestre:
EMPREGO.RG.sh$Mes <- ifelse(EMPREGO.RG.sh$Trimestre=="Q1",1,
ifelse(EMPREGO.RG.sh$Trimestre=="Q2",4,
ifelse(EMPREGO.RG.sh$Trimestre=="Q3",7,10)))
# no comando "ifelse", nao precisamos o "10" vai aparecer caso nenhum das condicoes forem aceitas
# ou seja, caso nao seja Q1, Q2 ou Q3 - isto e, estamos no Q4
#Agora podemos dizer pro R a data, ja que temos todos os elementos que precisamos
# Primeiro, vamos transformar o ano em numerico
EMPREGO.RG.sh$Ano <- as.numeric(EMPREGO.RG.sh$Ano)
# Agora dizer pro R que temos datas trimestrais, que serao identificadas pelo ano, mes e dia:
EMPREGO.RG.sh$Data <-as.yearqtr(with(EMPREGO.RG.sh,paste(Ano,Mes,Dia,sep="-")),"%Y-%m-%d")
# Por fim, vamos voltar a ter apenas a Taxa de Ocupação, Categoria e a Data:
EMPREGO.RG.sh<- EMPREGO.RG.sh %>%
select(Ocupado, Categoria, Data)
# echo = FALSE não mostra o código, mas mostra o resultado
# se a gente coloca include=FALSE o gráfico não aparece
# pq include=FALSE não mostra o resultado
ggplot(EMPREGO.RG.sh, aes(x=Data, y=Ocupado, color=Categoria))+
geom_line(size=2) + # definindo grossura da linha
ggtitle("Figura 1: Taxa de Ocupacao por Raça e Gênero") + #titulo do grafico
scale_colour_manual(values=c("#45ff66","#eb52ff", "#3366ff","#feff41")) + #cores Made
theme_bw() # colocando fundo Branco
#Realizando a alteração da coluna "Trimestre" do formato character para o formato date;
# Dividimos a coluna de data em uma de ano, e uma de trimestre:
date <- do.call(rbind, strsplit(EMPREGO.REG.sh$Trimestre, " "))
colnames(date)[colnames(date) <- c("Ano", "Trimestre")]
# Retornamos a data atualizada para o dataframe anterior
EMPREGO.REG.sh <- EMPREGO.REG.sh %>%
select(Ocupado, Regiao)
EMPREGO.REG.sh <- cbind(EMPREGO.REG.sh,date)
# Tendo as colunas de Ano e Trimestre, agora temos que criar as variaveis de dia e mes
# Definimos padrão para a criação dos trimestres, a partir do mês
EMPREGO.REG.sh$Dia <- 01
EMPREGO.REG.sh$Mes <- ifelse(EMPREGO.REG.sh$Trimestre=="Q1",1,
ifelse(EMPREGO.REG.sh$Trimestre=="Q2",4,
ifelse(EMPREGO.REG.sh$Trimestre=="Q3",7,10)))
EMPREGO.REG.sh$Ano <- as.numeric(EMPREGO.REG.sh$Ano)
# Agora dizer pro R que temos datas trimestrais, que serao identificadas pelo ano, mes e dia:
EMPREGO.REG.sh$Data <-as.yearqtr(with(EMPREGO.REG.sh,paste(Ano,Mes,Dia,sep="-")),"%Y-%m-%d")
# Voltamos para colunas originais
EMPREGO.REG.sh<- EMPREGO.REG.sh %>%
select(Ocupado, Regiao, Data)
#Checando formato
class(EMPREGO.REG.sh$Data)
ggplot(EMPREGO.REG.sh, aes(x=Data, y=Ocupado, color=Regiao)) +
geom_line(size=2) + # definindo grossura da linha
ggtitle("Figura 2: Taxa de Ocupação por Região") + #titulo do grafico
scale_colour_manual(values=c("#45ff66","#eb52ff", "#3366ff","#feff41", "#8968D3")) +
theme_bw() # colocando fundo Branco
# Variáveis
# Ex: PEA_homem_branco_trimestre_anterior <- PEA.RG.sh$PEA[PEA.RG.sh$Categoria == "Homem Branco" & PEA.RG.sh$Trimestre == "2023 Q3"]
# Renomeando colunas
colnames(Tx_emprego.sh)[colnames(Tx_emprego.sh) == "Taxa de emprego"] ="Taxa_emprego"
colnames(Tx_desemprego.sh)[colnames(Tx_desemprego.sh) == "Taxa de desemprego"] = "Taxa_desemprego"
# Criando objetos (atualizar trimestre de referência)
desemprego <- Tx_desemprego.sh$Taxa_desemprego[Tx_desemprego.sh$Trimestre == "2023 Q4"]
desemprego_tri_anterior <- Tx_desemprego.sh$Taxa_desemprego[Tx_desemprego.sh$Trimestre == "2023 Q3"]
desemprego_ano_anterior <- Tx_desemprego.sh$Taxa_desemprego[Tx_desemprego.sh$Trimestre == "2022 Q4"]
# Diferenças entre taxas de desemprego
dif_desem_tri <- ((desemprego)-(desemprego_tri_anterior))
dif_desem_ano <- ((desemprego)-(desemprego_ano_anterior))
## Desemprego por raça e gênero (Atualizar trimestre de referência)
desemprego_HB <- 1 - (EMPREGO.RG.sh$Ocupado[EMPREGO.RG.sh$Categoria == "Homem Branco" & EMPREGO.RG.sh$Data == "2023 Q4"])
desemprego_HN <- 1 - (EMPREGO.RG.sh$Ocupado[EMPREGO.RG.sh$Categoria == "Homem Negro" & EMPREGO.RG.sh$Data == "2023 Q4"])
desemprego_MB <- 1 - (EMPREGO.RG.sh$Ocupado[EMPREGO.RG.sh$Categoria == "Mulher Branca" & EMPREGO.RG.sh$Data == "2023 Q4"])
desemprego_MN <- 1 - (EMPREGO.RG.sh$Ocupado[EMPREGO.RG.sh$Categoria == "Mulher Negra" & EMPREGO.RG.sh$Data == "2023 Q4"])
##Trimestre anterior (atualizar trimestre de referência)
desemprego_hb_tri_anterior <- 1 - (EMPREGO.RG.sh$Ocupado[EMPREGO.RG.sh$Categoria == "Homem Branco" & EMPREGO.RG.sh$Data == "2023 Q3"])
desemprego_hn_tri_anterior <- 1 - (EMPREGO.RG.sh$Ocupado[EMPREGO.RG.sh$Categoria == "Homem Negro" & EMPREGO.RG.sh$Data == "2023 Q3"])
desemprego_mb_tri_anterior <- 1 - (EMPREGO.RG.sh$Ocupado[EMPREGO.RG.sh$Categoria == "Mulher Branca" & EMPREGO.RG.sh$Data == "2023 Q3"])
desemprego_mn_tri_anterior <- 1 - (EMPREGO.RG.sh$Ocupado[EMPREGO.RG.sh$Categoria == "Mulher Negra" & EMPREGO.RG.sh$Data == "2023 Q3"])
#desemtriMB <- (desemprego_MB - desem_triMB)
#desemtriMN <- (desemprego_MN - desem_triMN)
#desemtriHB <- (desemprego_HB - desem_triHB)
#desemtriHN <- (desemprego_HN - desem_triHN)
##Ano anterior (Atualizar data)
desemprego_hb_tri_ano_anterior <- 1 - (EMPREGO.RG.sh$Ocupado[EMPREGO.RG.sh$Categoria == "Homem Branco" & EMPREGO.RG.sh$Data == "2022 Q4"])
desemprego_hn_tri_ano_anterior <- 1 - (EMPREGO.RG.sh$Ocupado[EMPREGO.RG.sh$Categoria == "Homem Negro" & EMPREGO.RG.sh$Data == "2022 Q4"])
desemprego_mb_tri_ano_anterior <- 1 - (EMPREGO.RG.sh$Ocupado[EMPREGO.RG.sh$Categoria == "Mulher Branca" & EMPREGO.RG.sh$Data == "2022 Q4"])
desemprego_mn_tri_ano_anterior <- 1 - (EMPREGO.RG.sh$Ocupado[EMPREGO.RG.sh$Categoria == "Mulher Negra" & EMPREGO.RG.sh$Data == "2022 Q4"])
#desemanoMB <- (desemprego_MB - desemano_MB)
#desemanoMN <- (desemprego_MN - desemano_MN)
#desemanoHB <- (desemprego_HB - desemano_HB)
#desemanoHN <- (desemprego_HN - desemano_HN)
### Mínimos e máximos
# Máximo de 2023 Q4
max_RG_2023_04 <- EMPREGO.RG.sh %>%
filter(Data == "2023 Q4") %>% #filtro pelo trimestre que quero
filter(Ocupado == max(Ocupado)) %>% # e peço a linha correspondente ao valor máximo
select(Categoria) #peço a categoria associada
# Mínimo de 2023 Q4
min_RG_2023_04 <- EMPREGO.RG.sh %>%
filter(Data == "2023 Q4") %>% #filtro pelo trimestre que quero
filter(Ocupado == min(Ocupado)) %>%  # e peço a linha correspondente ao valor mínimo
select(Categoria) #peço a categoria associada
#Ordem
desemprego_RG <- c(desemprego_HB, desemprego_HN, desemprego_MB, desemprego_MN)
ordem_desemRG <- sort(desemprego_RG, decreasing = TRUE)
max_desemRG <- ordem_desemRG[1]
seg_desemRG <- ordem_desemRG[2]
ter_desemRG <- ordem_desemRG[3]
qua_desemRG <- ordem_desemRG[4]
#desemtri_RG <- c(desemtriMB, desemtriMN, desemtriHB, desemtriHN)
#ordem_desemtri_RG <- sort (desemtri_RG, decreasing = TRUE)
#max_desemtriRG <- ordem_desemtri_RG[1]
#seg_desemtriRG <- ordem_desemtri_RG[2]
#ter_desemtriRG <- ordem_desemtri_RG[3]
#qua_desemtriRG <- ordem_desemtri_RG[4]
#
#desemano_RG <- c(desemanoMB, desemanoMN, desemanoHB, desemanoHN)
#ordem_desemano_RG <- sort (desemano_RG, decreasing = TRUE)
#max_desemanoRG <- ordem_desemano_RG[1]
#seg_desemanoRG <- ordem_desemano_RG[2]
#ter_desemanoRG <- ordem_desemano_RG[3]
#qua_desemanoRG <- ordem_desemano_RG[4]
##Região (atualizar trimestre)
desemprego_norte <- (1 - (EMPREGO.REG.sh$Ocupado[EMPREGO.REG.sh$Regiao == "Norte" & EMPREGO.REG.sh$Data == "2023 Q4"]))
desemprego_nordeste <- (1 - (EMPREGO.REG.sh$Ocupado[EMPREGO.REG.sh$Regiao == "Nordeste" & EMPREGO.REG.sh$Data == "2023 Q4"]))
desemprego_centrooeste <- (1 - (EMPREGO.REG.sh$Ocupado[EMPREGO.REG.sh$Regiao == "Centro-Oeste" & EMPREGO.REG.sh$Data == "2023 Q4"]))
desemprego_sudeste <- (1 - (EMPREGO.REG.sh$Ocupado[EMPREGO.REG.sh$Regiao == "Sudeste" & EMPREGO.REG.sh$Data == "2023 Q4"]))
desemprego_sul <- (1 - (EMPREGO.REG.sh$Ocupado[EMPREGO.REG.sh$Regiao == "Sul" & EMPREGO.REG.sh$Data == "2023 Q4"]))
### Trimestre anterior (Atualizar data)
desemprego_norte_tri_anterior <- (1 - (EMPREGO.REG.sh$Ocupado[EMPREGO.REG.sh$Regiao == "Norte" & EMPREGO.REG.sh$Data == "2023 Q3"]))
desemprego_nordeste_tri_anterior <- (1 - (EMPREGO.REG.sh$Ocupado[EMPREGO.REG.sh$Regiao == "Nordeste" & EMPREGO.REG.sh$Data == "2023 Q3"]))
desemprego_centrooeste_tri_anterior <- (1 - (EMPREGO.REG.sh$Ocupado[EMPREGO.REG.sh$Regiao == "Centro-Oeste" & EMPREGO.REG.sh$Data == "2023 Q3"]))
desemprego_sudeste_tri_anterior <- (1 - (EMPREGO.REG.sh$Ocupado[EMPREGO.REG.sh$Regiao == "Sudeste" & EMPREGO.REG.sh$Data == "2023 Q3"]))
desemprego_sul_tri_anterior <- (1 - (EMPREGO.REG.sh$Ocupado[EMPREGO.REG.sh$Regiao == "Sul" & EMPREGO.REG.sh$Data == "2023 Q3"]))
#desemtriNO <- desemprego_NO - desemtri_NO
#desemtriNE <- desemprego_NE - desemtri_NE
#desemtriCO <- desemprego_CO - desemtri_CO
#desemtriSE <- desemprego_SE - desemtri_SE
#desemtriSU <- desemprego_SU - desemtri_SU
## Ano anterior, mesmo tri (atualizar datas)
desemprego_norte_tri_ano_anterio <- 1 - (EMPREGO.REG.sh$Ocupado[EMPREGO.REG.sh$Regiao == "Norte" & EMPREGO.REG.sh$Data == "2022 Q4"])
desemprego_nordeste_tri_ano_anterior <- 1 - (EMPREGO.REG.sh$Ocupado[EMPREGO.REG.sh$Regiao == "Nordeste" & EMPREGO.REG.sh$Data == "2022 Q4"])
desemprego_centrooeste_tri_ano_anterior <- 1 - (EMPREGO.REG.sh$Ocupado[EMPREGO.REG.sh$Regiao == "Centro-Oeste" & EMPREGO.REG.sh$Data == "2022 Q4"])
desemprego_sud_tri_ano_anterior <- 1 - (EMPREGO.REG.sh$Ocupado[EMPREGO.REG.sh$Regiao == "Sudeste" & EMPREGO.REG.sh$Data == "2022 Q4"])
desemprego_sul_tri_ano_anterior <- 1 - (EMPREGO.REG.sh$Ocupado[EMPREGO.REG.sh$Regiao == "Sul" & EMPREGO.REG.sh$Data == "2022 Q4"])
#desemanoNO <- desemprego_NO - desemano_NO
#desemanoNE <- desemprego_NE - desemano_NE
#desemanoCO <- desemprego_CO - desemano_CO
#desemanoSE <- desemprego_SE - desemano_SE
#desemanoSU <- desemprego_SU - desemano_SU
### Mínimos e máximos
# Máximo de 2023 Q4
max_REG_2023_04 <- EMPREGO.REG.sh %>%
filter(Data == "2023 Q4") %>% #filtro pelo trimestre que quero
filter(Ocupado == max(Ocupado)) %>% # e peço a linha correspondente ao valor máximo
select(Regiao) #peço a categoria associada
# Mínimo de 2023 Q4
min_REG_2023_04 <- EMPREGO.REG.sh %>%
filter(Data == "2023 Q4") %>% #filtro pelo trimestre que quero
filter(Ocupado == min(Ocupado)) %>%  # e peço a linha correspondente ao valor mínimo
select(Regiao) #peço a categoria associada
##Ordem
desemprego_REG <- c(desemprego_norte, desemprego_nordeste, desemprego_centrooeste, desemprego_sudeste, desemprego_sul)
ordem_desemREG <- sort (desemprego_REG, decreasing = TRUE)
max_desemREG <- ordem_desemREG[1]
seg_desemREG <- ordem_desemREG[2]
ter_desemREG <- ordem_desemREG[3]
qua_desemREG <- ordem_desemREG[4]
qui_desemREG <- ordem_desemREG[5]
#desem_triREG <- c(desemtriNO, desemtriNE, desemtriCO, desemtriSE, desemtriSU)
#ordem_desem_triREG <- sort(desem_triREG, decreasing = TRUE)
#max_desemtriREG <- ordem_desem_triREG[1]
#seg_desemtriREG <- ordem_desem_triREG[2]
#ter_desemtriREG <- ordem_desem_triREG[3]
#qua_desemtriREG <- ordem_desem_triREG[4]
#qui_desemtriREG <- ordem_desem_triREG[5]
#desem_anoREG <- c(desemanoNO, desemanoNE, desemanoCO, desemanoSE, desemanoSU)
#ordem_desem_anoREG <- sort(desem_anoREG, decreasing = TRUE)
#max_desemanoREG <- ordem_desem_anoREG[1]
#seg_desemanoREG <- ordem_desem_anoREG[2]
#ter_desemanoREG <- ordem_desem_anoREG[3]
#qua_desemanoREG <- ordem_desem_anoREG[4]
#qui_desemanoREG <- ordem_desem_anoREG[5]
#Realizando a alteração da coluna "Trimestre" do formato character para o formato date;
#Renomeando colunas
colnames(informal.RG.sh)[colnames(informal.RG.sh) == "não contribuinte INSS"] = "Informal"
colnames(informal.RG.sh)[colnames(informal.RG.sh) == "contribuinte INSS"] = "Formal"
# Dividimos a coluna de data em uma de ano, e uma de trimestre:
date <- do.call(rbind, strsplit(informal.RG.sh$Trimestre, " "))
colnames(date)[colnames(date) <- c("Ano", "Trimestre")]
# Retornamos a data atualizada para o dataframe anterior
informal.RG.sh <- informal.RG.sh %>%
select(Categoria, Formal, Informal)
informal.RG.sh <- cbind(informal.RG.sh,date)
# Tendo as colunas de Ano e Trimestre, agora temos que criar as variaveis de dia e mes
# Definimos padrão para a criação dos trimestres, a partir do mês
informal.RG.sh$Dia <- 01
informal.RG.sh$Mes <- ifelse(informal.RG.sh$Trimestre=="Q1",1,
ifelse(informal.RG.sh$Trimestre=="Q2",4,
ifelse(informal.RG.sh$Trimestre=="Q3",7,10)))
informal.RG.sh$Ano <- as.numeric(informal.RG.sh$Ano)
# Agora dizer pro R que temos datas trimestrais, que serao identificadas pelo ano, mes e dia:
informal.RG.sh$Data <-as.yearqtr(with(informal.RG.sh,paste(Ano,Mes,Dia,sep="-")),"%Y-%m-%d")
# Voltamos para colunas originais
informal.RG.sh<- informal.RG.sh %>%
select(Categoria, Formal, Informal, Data)
#Checando formato
class(informal.RG.sh$Data)
ggplot(informal.RG.sh, aes(x=Data, y=Informal, color=Categoria)) +
geom_line(size=2) + # definindo grossura da linha
ggtitle("Figura 3: Taxa de Informalidade por Raça e Gênero") + #titulo do grafico
scale_colour_manual(values=c("#45ff66","#eb52ff", "#3366ff","#feff41")) +
theme_bw() # colocando fundo Branco
#Realizando a alteração da coluna "Trimestre" do formato character para o formato date;
#Renomeando colunas
colnames(informal.REG.sh)[colnames(informal.REG.sh) == "não contribuinte INSS"] = "Informal"
colnames(informal.REG.sh)[colnames(informal.REG.sh) == "contribuinte INSS"] = "Formal"
# Dividimos a coluna de data em uma de ano, e uma de trimestre:
date <- do.call(rbind, strsplit(informal.REG.sh$Trimestre, " "))
colnames(date)[colnames(date) <- c("Ano", "Trimestre")]
# Retornamos a data atualizada para o dataframe anterior
informal.REG.sh <- informal.REG.sh %>%
select(Regiao, Formal, Informal)
informal.REG.sh <- cbind(informal.REG.sh,date)
# Tendo as colunas de Ano e Trimestre, agora temos que criar as variaveis de dia e mes
# Definimos padrão para a criação dos trimestres, a partir do mês
informal.REG.sh$Dia <- 01
informal.REG.sh$Mes <- ifelse(informal.REG.sh$Trimestre=="Q1",1,
ifelse(informal.REG.sh$Trimestre=="Q2",4,
ifelse(informal.REG.sh$Trimestre=="Q3",7,10)))
informal.REG.sh$Ano <- as.numeric(informal.REG.sh$Ano)
# Agora dizer pro R que temos datas trimestrais, que serao identificadas pelo ano, mes e dia:
informal.REG.sh$Data <-as.yearqtr(with(informal.REG.sh,paste(Ano,Mes,Dia,sep="-")),"%Y-%m-%d")
# Voltamos para colunas originais
informal.REG.sh<- informal.REG.sh %>%
select(Regiao, Formal, Informal, Data)
#Checando formato
class(informal.RG.sh$Data)
ggplot(informal.REG.sh, aes(x=Data, y=Informal, color=Regiao)) +
geom_line(size=2) + # definindo grossura da linha
ggtitle("Figura 4: Taxa de Informalidade por Região") + #titulo do grafico
scale_colour_manual(values=c("#45ff66","#eb52ff", "#3366ff","#feff41", "#8968D3")) +
theme_bw() # colocando fundo Branco
# Informalidade média - atualizando data
#Renomeando colunas
colnames(informalidadeMedia.sh)[colnames(informalidadeMedia.sh) == "Taxa média de informalidade"] = "informalidade_media"
#Realizando a alteração da coluna "Trimestre" do formato character para o formato date;
# Dividimos a coluna de data em uma de ano, e uma de trimestre:
date <- do.call(rbind, strsplit(informalidadeMedia.sh$Trimestre, " "))
colnames(date)[colnames(date) <- c("Ano", "Trimestre")]
# Retornamos a data atualizada para o dataframe anterior
informalidadeMedia.sh <- informalidadeMedia.sh %>%
select(informalidade_media)
informalidadeMedia.sh <- cbind(informalidadeMedia.sh,date)
# Tendo as colunas de Ano e Trimestre, agora temos que criar as variaveis de dia e mes
# Definimos padrão para a criação dos trimestres, a partir do mês
informalidadeMedia.sh$Dia <- 01
informalidadeMedia.sh$Mes <- ifelse(informalidadeMedia.sh$Trimestre=="Q1",1,
ifelse(informalidadeMedia.sh$Trimestre=="Q2",4,
ifelse(informalidadeMedia.sh$Trimestre=="Q3",7,10)))
informalidadeMedia.sh$Ano <- as.numeric(informalidadeMedia.sh$Ano)
# Agora dizer pro R que temos datas trimestrais, que serao identificadas pelo ano, mes e dia:
informalidadeMedia.sh$Data <-as.yearqtr(with(informalidadeMedia.sh,paste(Ano,Mes,Dia,sep="-")),"%Y-%m-%d")
# Voltamos para colunas originais
informalidadeMedia.sh<- informalidadeMedia.sh %>%
select(informalidade_media, Data)
#Checando formato
class(informal.RG.sh$Data)
# Informalidade média (Atualizar tri e ano)
informalidade <- informalidadeMedia.sh$informalidade_media[informalidadeMedia.sh$Data == "2023 Q4"]
informalidade_tri_anterior <- informalidadeMedia.sh$informalidade_media[informalidadeMedia.sh$Data == "2023 Q3"]
dif_informalidade_tri <- informalidade - informalidade_tri_anterior
#Região
inf_NO <- informal.REG.sh$Informal[informal.REG.sh$Regiao == "Norte" & informal.REG.sh$Data == "2023 Q4"]
inf_NE <- informal.REG.sh$Informal[informal.REG.sh$Regiao == "Nordeste" & informal.REG.sh$Data == "2023 Q4"]
inf_CO <- informal.REG.sh$Informal[informal.REG.sh$Regiao == "Centro-Oeste" & informal.REG.sh$Data == "2023 Q4"]
inf_SE <- informal.REG.sh$Informal[informal.REG.sh$Regiao == "Sudeste" & informal.REG.sh$Data == "2023 Q4"]
inf_SU <- informal.REG.sh$Informal[informal.REG.sh$Regiao == "Sul" & informal.REG.sh$Data == "2023 Q4"]
## Tri anterior
informal_tri_anterior_NO <- informal.REG.sh$Informal[informal.REG.sh$Regiao == "Norte" & informal.REG.sh$Data == "2023 Q3"]
informal_tri_anterior_NE <- informal.REG.sh$Informal[informal.REG.sh$Regiao == "Nordeste" & informal.REG.sh$Data == "2023 Q3"]
informal_tri_anterior_CO <- informal.REG.sh$Informal[informal.REG.sh$Regiao == "Centro-Oeste" & informal.REG.sh$Data == "2023 Q3"]
informal_tri_anterior_SE <- informal.REG.sh$Informal[informal.REG.sh$Regiao == "Sudeste" & informal.REG.sh$Data == "2023 Q3"]
informal_tri_anterior_SU <- informal.REG.sh$Informal[informal.REG.sh$Regiao == "Sul" & informal.REG.sh$Data == "2023 Q3"]
#inf_triNO <- ((inf_NO) - (informal_triNO))
#inf_triNE <- inf_NE - informal_triNE
#inf_triCO <- inf_CO - informal_triCO
#inf_triSE <- inf_SE - informal_triSE
#inf_triSU <- inf_SU - informal_triSU
## Ano anterior (Atualizar ano e tri)
informal_ano_anterior_NO <- informal.REG.sh$Informal[informal.REG.sh$Regiao == "Norte" & informal.REG.sh$Data == "2022 Q4"]
informal_ano_anterior_NE <- informal.REG.sh$Informal[informal.REG.sh$Regiao == "Nordeste" & informal.REG.sh$Data == "2022 Q4"]
informal_ano_anterior_CO <- informal.REG.sh$Informal[informal.REG.sh$Regiao == "Centro-Oeste" & informal.REG.sh$Data == "2022 Q4"]
informal_ano_anterior_SE <- informal.REG.sh$Informal[informal.REG.sh$Regiao == "Sudeste" & informal.REG.sh$Data == "2022 Q4"]
informal_ano_anterior_SU <- informal.REG.sh$Informal[informal.REG.sh$Regiao == "Sul" & informal.REG.sh$Data == "2022 Q4"]
#inf_anoNO <- inf_NO - informal_anoNO
#inf_anoNE <- inf_NE - informal_anoNE
#inf_anoCO <- inf_CO - informal_anoCO
#inf_anoSE <- inf_SE - informal_anoSE
#inf_anoSU <- inf_SU - informal_anoSU
### Mínimos e máximos
# Máximo de 2023 Q4
max_Inf_REG_2023_04 <- informal.REG.sh %>%
filter(Data == "2023 Q4") %>% #filtro pelo trimestre que quero
filter(Informal == max(Informal)) %>% # e peço a linha correspondente ao valor máximo
select(Regiao) #peço a categoria associada
# Mínimo de 2023 Q4
min_INF_REG_2023_04 <- informal.REG.sh %>%
filter(Data == "2023 Q4") %>% #filtro pelo trimestre que quero
filter(Informal == min(Informal)) %>%  # e peço a linha correspondente ao valor mínimo
select(Regiao) #peço a categoria associada
#Ordem
informalREG <- c(inf_NO, inf_NE, inf_CO, inf_SE, inf_SU)
ordem_infREG <- sort(informalREG, decreasing = TRUE)
max_infREG <- ordem_infREG[1]
seg_infREG <- ordem_infREG[2]
ter_infREG <- ordem_infREG[3]
qua_infREG <- ordem_infREG[4]
qui_infREG <- ordem_infREG[5]
#inftri_REG <- c(inf_triNO, inf_triNE, inf_triCO, inf_triSE, inf_triSU)
#ordem_inftriREG <- sort(inftri_REG, decreasing = TRUE)
#max_inftriREG <- ordem_inftriREG[1]
#seg_inftriREG <- ordem_inftriREG[2]
#ter_inftriREG <- ordem_inftriREG[3]
#qua_inftriREG <- ordem_inftriREG[4]
#qui_inftriREG <- ordem_inftriREG[5]
#infano_REG <- c(inf_anoNO, inf_anoNE, inf_anoCO, inf_anoSE, inf_anoSU)
#ordem_infanoREG <- sort(infano_REG, decreasing = TRUE)
#max_infanoREG <- ordem_infanoREG[1]
#seg_infanoREG <- ordem_infanoREG[2]
#ter_infanoREG <- ordem_infanoREG[3]
#qua_infanoREG <- ordem_infanoREG[4]
#qui_infanoREG <- ordem_infanoREG[5]
# Raça e gênero
informal_HB <- informal.RG.sh$Informal[informal.RG.sh$Categoria == "Homem Branco" & informal.RG.sh$Data == "2023 Q4"]
informal_HN <- informal.RG.sh$Informal[informal.RG.sh$Categoria == "Homem Negro" & informal.RG.sh$Data == "2023 Q4"]
informal_MB <- informal.RG.sh$Informal[informal.RG.sh$Categoria == "Mulher Branca" & informal.RG.sh$Data == "2023 Q4"]
informal_MN <- informal.RG.sh$Informal[informal.RG.sh$Categoria == "Mulher Negra" & informal.RG.sh$Data == "2023 Q4"]
##Tri anterior
informal_tri_anterior_HB <- informal.RG.sh$Informal[informal.RG.sh$Categoria == "Homem Branco" & informal.RG.sh$Data == "2023 Q3"]
informal_tri_anterior_HN <- informal.RG.sh$Informal[informal.RG.sh$Categoria == "Homem Negro" & informal.RG.sh$Data == "2023 Q3"]
informal_tri_anterior_MB <- informal.RG.sh$Informal[informal.RG.sh$Categoria == "Mulher Branca" & informal.RG.sh$Data == "2023 Q3"]
informal_tri_anterior_MN <- informal.RG.sh$Informal[informal.RG.sh$Categoria == "Mulher Negra" & informal.RG.sh$Data == "2023 Q3"]
diftri_informalidadeHB <- informal_HB - informal_tri_anterior_HB
diftri_informalidadeHN <- informal_HN - informal_tri_anterior_HN
diftri_informalidadeMB <- informal_HB - informal_tri_anterior_MB
diftri_informalidadeMN <- informal_HN - informal_tri_anterior_MN
## Ano anterior
informalidade_ano_anterior <- informalidadeMedia.sh$informalidade_media[informalidadeMedia.sh$Data == "2022 Q4"]
difano_informalRG <- informalidade - informalidade_ano_anterior
informal_ano_anterior_HB <- informal.RG.sh$Informal[informal.RG.sh$Categoria == "Homem Branco" & informal.RG.sh$Data == "2022 Q4"]
informal_ano_anterior_HN <- informal.RG.sh$Informal[informal.RG.sh$Categoria == "Homem Negro" & informal.RG.sh$Data == "2022 Q4"]
informal_ano_anterior_MB <- informal.RG.sh$Informal[informal.RG.sh$Categoria == "Mulher Branca" & informal.RG.sh$Data == "2022 Q4"]
informal_ano_anterior_MN <- informal.RG.sh$Informal[informal.RG.sh$Categoria == "Mulher Negra" & informal.RG.sh$Data == "2022 Q4"]
dif_infanoHB <- informal_HB - informal_ano_anterior_HB
dif_infanoHN <- informal_HN - informal_ano_anterior_HN
dif_infanoMB <- informal_MB - informal_ano_anterior_MB
dif_infanoMN <- informal_MB - informal_ano_anterior_MN
### Mínimos e máximos
# Máximo de 2023 Q4
max_Inf_RG_2023_04 <- informal.RG.sh %>%
filter(Data == "2023 Q4") %>% #filtro pelo trimestre que quero
filter(Informal == max(Informal)) %>% # e peço a linha correspondente ao valor máximo
select(Categoria) #peço a categoria associada
# Mínimo de 2023 Q4
min_INF_RG_2023_04 <- informal.RG.sh %>%
filter(Data == "2023 Q4") %>% #filtro pelo trimestre que quero
filter(Informal == min(Informal)) %>%  # e peço a linha correspondente ao valor mínimo
select(Categoria) #peço a categoria associada
# Ordem
informalRG <- c(informal_HB, informal_HN, informal_MB, informal_MN)
ordem_infRG <- sort(informalRG, decreasing = TRUE)
max_infRG <- ordem_infRG[1]
seg_infRG <- ordem_infRG[2]
ter_infRG <- ordem_infRG[3]
qua_infRG <- ordem_infRG[4]
diftri_informalidadeRG <- c(diftri_informalidadeHB, diftri_informalidadeHN, diftri_informalidadeMB, diftri_informalidadeMN)
ordem_diftri <- sort(diftri_informalidadeRG, decreasing = TRUE)
max_inftriRG <- ordem_diftri[1]
seg_inftriRG <- ordem_diftri[2]
ter_inftriRG <- ordem_diftri[3]
qua_inftriRG <- ordem_diftri[4]
infano_RG <- c(dif_infanoHB, dif_infanoHN, dif_infanoMB, dif_infanoMN)
ordem_infanoRG <- sort(infano_RG, decreasing = TRUE)
max_infanoRG <- ordem_infanoRG[1]
seg_infanoRG <- ordem_infanoRG[2]
ter_infanoRG <- ordem_infanoRG[3]
qua_infanoRG <- ordem_infanoRG[4]
#colnames(trabalhosetor.RG.sh)[colnames(trabalhosetor.RG.sh) == "Homem Branco"] = "Homem_Branco"
colnames(trabalhosetor.RG.sh)[colnames(trabalhosetor.RG.sh) == "Administração Pública"] = "Adm_pública"
colnames(trabalhosetor.RG.sh)[colnames(trabalhosetor.RG.sh) == "Outros serviços"] = "Outros_serviços"
colnames(trabalhosetor.RG.sh)[colnames(trabalhosetor.RG.sh) == "Serviços domésticos"] = "Ser_domesticos"
#Homem Branco
HB_agro <- trabalhosetor.RG.sh$Agropecuária[trabalhosetor.RG.sh$Categoria == "Homem Branco" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
HB_ind <- trabalhosetor.RG.sh$Indústria[trabalhosetor.RG.sh$Categoria == "Homem Branco" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
HB_const <- trabalhosetor.RG.sh$Construção[trabalhosetor.RG.sh$Categoria == "Homem Branco" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
HB_comercio <- trabalhosetor.RG.sh$Comércio[trabalhosetor.RG.sh$Categoria == "Homem Branco" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
HB_tran <- trabalhosetor.RG.sh$Transporte[trabalhosetor.RG.sh$Categoria == "Homem Branco" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
HB_alimen <- trabalhosetor.RG.sh$Alimentação[trabalhosetor.RG.sh$Categoria == "Homem Branco" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
HB_info <- trabalhosetor.RG.sh$Informação[trabalhosetor.RG.sh$Categoria == "Homem Branco" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
HB_publico <- trabalhosetor.RG.sh$Adm_pública[trabalhosetor.RG.sh$Categoria == "Homem Branco" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
HB_educa <- trabalhosetor.RG.sh$Educação[trabalhosetor.RG.sh$Categoria == "Homem Branco" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
HB_oserv <- trabalhosetor.RG.sh$Outros_serviços[trabalhosetor.RG.sh$Categoria == "Homem Branco" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
HB_domes <- trabalhosetor.RG.sh$Ser_domesticos[trabalhosetor.RG.sh$Categoria == "Homem Branco" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
setores_HB <- c(HB_agro, HB_ind, HB_const, HB_comercio, HB_tran, HB_alimen, HB_info, HB_publico, HB_educa, HB_oserv, HB_domes)
ordem_HB <- sort(setores_HB, decreasing = TRUE)
max_HB <- ordem_HB[1]
seg_HB <- ordem_HB[2]
ter_HB <- ordem_HB[3]
qua_HB <- ordem_HB[4]
qui_HB <- ordem_HB[5]
#Homem negro
HN_agro <- trabalhosetor.RG.sh$Agropecuária[trabalhosetor.RG.sh$Categoria == "Homem Negro" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
HN_ind <- trabalhosetor.RG.sh$Indústria[trabalhosetor.RG.sh$Categoria == "Homem Negro" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
HN_const <- trabalhosetor.RG.sh$Construção[trabalhosetor.RG.sh$Categoria == "Homem Negro" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
HN_comercio <- trabalhosetor.RG.sh$Comércio[trabalhosetor.RG.sh$Categoria == "Homem Negro" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
HN_tran <- trabalhosetor.RG.sh$Transporte[trabalhosetor.RG.sh$Categoria == "Homem Negro" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
HN_alimen <- trabalhosetor.RG.sh$Alimentação[trabalhosetor.RG.sh$Categoria == "Homem Negro" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
HN_info <- trabalhosetor.RG.sh$Informação[trabalhosetor.RG.sh$Categoria == "Homem Negro" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
HN_publico <- trabalhosetor.RG.sh$Adm_pública[trabalhosetor.RG.sh$Categoria == "Homem Negro" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
HN_educa <- trabalhosetor.RG.sh$Educação[trabalhosetor.RG.sh$Categoria == "Homem Negro" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
HN_oserv <- trabalhosetor.RG.sh$Outros_serviços[trabalhosetor.RG.sh$Categoria == "Homem Negro" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
HN_domes <- trabalhosetor.RG.sh$Ser_domesticos[trabalhosetor.RG.sh$Categoria == "Homem Negro" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
setores_HN <- c(HN_agro, HN_ind, HN_const, HN_comercio, HN_tran, HN_alimen, HN_info, HN_publico, HN_educa, HN_oserv, HN_domes)
ordem_HN <- sort(setores_HN, decreasing = TRUE)
max_HN <- ordem_HN[1]
seg_HN <- ordem_HN[2]
ter_HN <- ordem_HN[3]
qua_HN <- ordem_HN[4]
qui_HN <- ordem_HN[5]
#Mulher Branca
MB_agro <- trabalhosetor.RG.sh$Agropecuária[trabalhosetor.RG.sh$Categoria == "Mulher Branca" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
MB_const <- trabalhosetor.RG.sh$Construção[trabalhosetor.RG.sh$Categoria == "Mulher Branca" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
MB_comercio <- trabalhosetor.RG.sh$Comércio[trabalhosetor.RG.sh$Categoria == "Mulher Branca" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
MB_tran <- trabalhosetor.RG.sh$Transporte[trabalhosetor.RG.sh$Categoria == "Mulher Branca" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
MB_alimen <- trabalhosetor.RG.sh$Alimentação[trabalhosetor.RG.sh$Categoria == "Mulher Branca" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
MB_info <- trabalhosetor.RG.sh$Informação[trabalhosetor.RG.sh$Categoria == "Mulher Branca" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
MB_publico <- trabalhosetor.RG.sh$Adm_pública[trabalhosetor.RG.sh$Categoria == "Mulher Branca" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
MB_educa <- trabalhosetor.RG.sh$Educação[trabalhosetor.RG.sh$Categoria == "Mulher Branca" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
MB_oserv <- trabalhosetor.RG.sh$Outros_serviços[trabalhosetor.RG.sh$Categoria == "Mulher Branca" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
MB_domes <- trabalhosetor.RG.sh$Ser_domesticos[trabalhosetor.RG.sh$Categoria == "Mulher Branca" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
MB_ind <- trabalhosetor.RG.sh$Indústria[trabalhosetor.RG.sh$Categoria == "Mulher Branca" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
setores_MB <- c(MB_agro, MB_ind, MB_const, MB_comercio, MB_tran, MB_alimen, MB_info, MB_publico, MB_educa, MB_oserv, MB_domes)
ordem_MB <- sort(setores_MB, decreasing = TRUE)
max_MB <- ordem_MB[1]
seg_MB <- ordem_MB[2]
ter_MB <- ordem_MB[3]
qua_MB <- ordem_MB[4]
qui_MB <- ordem_MB[5]
#Mulher Negra
MN_agro <- trabalhosetor.RG.sh$Agropecuária[trabalhosetor.RG.sh$Categoria == "Mulher Negra" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
MN_const <- trabalhosetor.RG.sh$Construção[trabalhosetor.RG.sh$Categoria == "Mulher Negra" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
MN_comercio <- trabalhosetor.RG.sh$Comércio[trabalhosetor.RG.sh$Categoria == "Mulher Negra" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
MN_tran <- trabalhosetor.RG.sh$Transporte[trabalhosetor.RG.sh$Categoria == "Mulher Negra" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
MN_alimen <- trabalhosetor.RG.sh$Alimentação[trabalhosetor.RG.sh$Categoria == "Mulher Negra" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
MN_info <- trabalhosetor.RG.sh$Informação[trabalhosetor.RG.sh$Categoria == "Mulher Negra" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
MN_publico <- trabalhosetor.RG.sh$Adm_pública[trabalhosetor.RG.sh$Categoria == "Mulher Negra" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
MN_educa <- trabalhosetor.RG.sh$Educação[trabalhosetor.RG.sh$Categoria == "Mulher Negra" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
MN_oserv <- trabalhosetor.RG.sh$Outros_serviços[trabalhosetor.RG.sh$Categoria == "Mulher Negra" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
MN_domes <- trabalhosetor.RG.sh$Ser_domesticos[trabalhosetor.RG.sh$Categoria == "Mulher Negra" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
MN_ind <- trabalhosetor.RG.sh$Indústria[trabalhosetor.RG.sh$Categoria == "Mulher Negra" & EMPREGO.RG.sh$Trimestre == "2023 Q4"]
setores_MN <- c(MN_agro, MN_ind, MN_const, MN_comercio, MN_tran, MN_alimen, MN_info, MN_publico, MN_educa, MN_oserv, MN_domes)
ordem_MN <- sort(setores_MN, decreasing = TRUE)
max_MN <- ordem_MN[1]
seg_MN <- ordem_MN[2]
ter_MN <- ordem_MN[3]
qua_MN <- ordem_MN[4]
qui_MN <- ordem_MN[5]
renda_med <- RendaHabitMedia.sh$RendaHabitMedia[RendaHabitMedia.sh$Trimestre == "2023 Q4"]
# Raça e gênero
rendahabitHB <- RendaHabit.RG.sh$Renda_Habitual_RG[RendaHabit.RG.sh$Categoria == "Homem Branco" & RendaHabit.RG.sh$Trimestre == "2023 Q4"]
rendahabitHN <- RendaHabit.RG.sh$Renda_Habitual_RG[RendaHabit.RG.sh$Categoria == "Homem Negro" & RendaHabit.RG.sh$Trimestre == "2023 Q4"]
rendahabitMB <- RendaHabit.RG.sh$Renda_Habitual_RG[RendaHabit.RG.sh$Categoria == "Mulher Branca" & RendaHabit.RG.sh$Trimestre == "2023 Q4"]
rendahabitMN <- RendaHabit.RG.sh$Renda_Habitual_RG[RendaHabit.RG.sh$Categoria == "Mulher Negra" & RendaHabit.RG.sh$Trimestre == "2023 Q4"]
##Ano anterior
rendahabitano_HB <- RendaHabit.RG.sh$Renda_Habitual_RG[RendaHabit.RG.sh$Categoria == "Homem Branco" & RendaHabit.RG.sh$Trimestre == "2022 Q4"]
rendahabitano_HN <- RendaHabit.RG.sh$Renda_Habitual_RG[RendaHabit.RG.sh$Categoria == "Homem Negro" & RendaHabit.RG.sh$Trimestre == "2022 Q4"]
rendahabitano_MB <- RendaHabit.RG.sh$Renda_Habitual_RG[RendaHabit.RG.sh$Categoria == "Mulher Branca" & RendaHabit.RG.sh$Trimestre == "2022 Q4"]
rendahabitano_MN <- RendaHabit.RG.sh$Renda_Habitual_RG[RendaHabit.RG.sh$Categoria == "Mulher Negra" & RendaHabit.RG.sh$Trimestre == "2022 Q4"]
rendahabitanoHB <- (rendahabitHB - rendahabitano_HB)
rendahabitanoHN <- (rendahabitHN - rendahabitano_HN)
rendahabitanoMB <- (rendahabitMB - rendahabitano_MB)
rendahabitanoMN <- (rendahabitMN - rendahabitano_MN)
rendahabitRG <- c(rendahabitHB, rendahabitHN, rendahabitMB, rendahabitMN)
ordemrendahabitRG <- sort(rendahabitRG, decreasing = TRUE)
max_renhab <- ordemrendahabitRG[1]
seg_renhab <- ordemrendahabitRG[2]
ter_renhab <- ordemrendahabitRG[3]
qua_renhab <- ordemrendahabitRG[4]
#ano
rendahabitanoRG <- c(rendahabitanoHB, rendahabitanoHN, rendahabitanoMB, rendahabitanoMN)
ordem_renhabRG <- sort(rendahabitanoRG, decreasing = TRUE)
max_renhab_ano <- ordem_renhabRG[1]
seg_renhab_ano <- ordem_renhabRG[2]
ter_renhab_ano <- ordem_renhabRG[3]
qua_renhab_ano <- ordem_renhabRG[4]
giniBR <- giniBR.sh$gini[giniBR.sh$Trimestre == "2023 Q4"]
giniBR_ano <- giniBR.sh$gini[giniBR.sh$Trimestre == "2022 Q4"]
giniBR_tri <- giniBR.sh$gini[giniBR.sh$Trimestre == "2023 Q3"]
